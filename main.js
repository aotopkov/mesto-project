(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e,t){e.classList.remove("popup_opened"),document.removeEventListener("keydown",n),e.removeEventListener("click",r)}function n(e){"Escape"===e.key&&t(document.querySelector(".popup_opened"))}function o(e){e.classList.add("popup_opened"),document.addEventListener("keydown",n),e.addEventListener("click",r)}function r(e){(e.target.classList.contains("popup__btn-exit")||e.target.classList.contains("popup"))&&t(e.currentTarget)}function c(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(e.classList.remove(n.submitButtonInactive),e.disabled=!1):(e.classList.add(n.submitButtonInactive),e.disabled=!0)}e.d({},{rC:()=>y});var a=document.forms.newcard,i=document.querySelector(".cards"),s=document.querySelector(".template__card").content,u=document.querySelector(".fullcard"),l=document.querySelector(".fullcard__name"),d=document.querySelector(".fullcard__img"),m=document.querySelector(".popup__card-delete");function f(e,n,r,c,a){var i=s.querySelector(".card").cloneNode(!0);i.id=a,i.querySelector(".card__name").textContent=e;var f=i.querySelector(".card__image");f.setAttribute("src",n),f.setAttribute("alt",e);var p=i.querySelector(".card__like"),_=i.querySelector(".card__like-counter");_.textContent=r.length,r.some((function(e){if(e.name==y.textContent)return!0}))&&p.classList.add("card__like_active"),p.addEventListener("click",(function(e){e.target.classList.contains("card__like_active")?function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/likes/"+e,{method:"DELETE",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934","Content-Type":"application/json"}})}(i.id).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){e.target.classList.remove("card__like_active"),_.textContent=t.likes.length})):function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/likes/"+e,{method:"PUT",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934","Content-Type":"application/json"}})}(i.id).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){e.target.classList.add("card__like_active"),_.textContent=t.likes.length}))}));var h=i.querySelector(".card__delete");return c!==y.textContent?h.classList.add("card__delete_hidden"):h.addEventListener("click",(function(){(function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/"+e,{method:"DELETE",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934"}})})(a).then((function(e){if(!e.ok)return Promise.reject("Ошибка: ".concat(e.status));i.closest(".card").remove(),t(m)})).catch((function(e){console.log(e)}))})),i.querySelector(".card__full-btn").addEventListener("click",(function(){o(u),l.textContent=e,d.setAttribute("src",n),d.setAttribute("alt",e)})),i}var p,_=document.querySelector(".profile__btn-edit"),h=document.querySelector(".card__btn-add"),v=document.forms.editprofile,y=document.querySelector(".profile__data-name"),b=document.querySelector(".profile__data-about"),S=document.querySelector(".profile__avatar"),k=document.querySelector(".popup_section_profile"),C=document.querySelector(".popup_section_card"),q=document.querySelector(".profile__btn-edit-avatar"),L=document.querySelector(".popup__avatar-edit"),g=document.forms.avataredit;fetch("https://nomoreparties.co/v1/plus-cohort-14/users/me",{headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){y.textContent=e.name,b.textContent=e.about,S.setAttribute("src",e.avatar)})).catch((function(e){console.log(e)})),_.addEventListener("click",(function(){o(k),v.elements.name__input.value=y.textContent,v.elements.about__input.value=b.textContent,v.elements.submit.disabled=!1})),v.addEventListener("submit",(function(e){var n;e.preventDefault(),v.elements.submit.textContent="Сохранение...",(n=v,fetch("https://nomoreparties.co/v1/plus-cohort-14/users/me",{method:"PATCH",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934","Content-Type":"application/json"},body:JSON.stringify({name:n.elements.name__input.value,about:n.elements.about__input.value})})).then((function(e){if(!e.ok)return Promise.reject("Ошибка: ".concat(e.status));y.textContent=v.elements.name__input.value,b.textContent=v.elements.about__input.value,v.elements.submit.textContent="Сохранить",t(k)})).catch((function(e){console.log(e)}))})),q.addEventListener("click",(function(){o(L)})),g.addEventListener("submit",(function(e){var n;e.preventDefault(),g.elements.submit.textContent="Cохраняем...",(n=g,fetch("https://nomoreparties.co/v1/plus-cohort-14/users/me/avatar/",{method:"PATCH",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934","Content-Type":"application/json"},body:JSON.stringify({avatar:n.link.value})})).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(n){S.setAttribute("src",n.avatar),t(L),g.elements.submit.textContent="Cохранить",e.target.reset(),g.elements.submit.disabled=!0})).catch((function(e){console.log(e)}))})),fetch("https://nomoreparties.co/v1/plus-cohort-14/cards",{headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){i.prepend(f(e.name,e.link,e.likes,e.owner.name,e._id))}))})).catch((function(e){console.log(e)})),h.addEventListener("click",(function(){o(C)})),a.addEventListener("submit",(function(e){e.preventDefault(),a.elements.submit.textContent="Создаём...",function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-14/cards",{method:"POST",headers:{authorization:"f9e9e49f-0819-4dc4-9e7e-0ee189046934","Content-Type":"application/json"},body:JSON.stringify({name:e.elements.name.value,link:e.elements.link.value})})}(a).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(n){i.prepend(f(n.name,n.link,n.likes,n.owner.name,n._id)),t(C),a.elements.submit.textContent="Cоздать",e.target.reset(),a.elements.submit.disabled=!0})).catch((function(e){console.log(e)}))})),p={formSelector:".forms",inputSelector:".forms__input",submitButtonSelector:".forms__submit",submitButtonInactive:".forms__submit_inactive"},Array.from(document.querySelectorAll(p.formSelector)).forEach((function(e){var t=Array.from(e.querySelectorAll(p.inputSelector));t.forEach((function(n){!function(e,t,n,o){var r=e.querySelector(o.submitButtonSelector);c(r,t,o),n.addEventListener("input",(function(){!function(e,t){var n=e.querySelector(".".concat(t.id,"_error"));t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e){e.textContent=""}(n):function(e,t){e.textContent=t}(n,t.validationMessage)}(e,n),c(r,t,o)}))}(e,t,n,p)}))}))})();